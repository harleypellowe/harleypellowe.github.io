---
title: Codenames - Part 1
subtitle: Creating the word list
author: harley
top_image: http://clipart-library.com/images/yTkqXknTE.jpg
published: false
---

hey

* Why do this?
* Premise of blog
    * Have fun in GS
    * Push GS to the limits
    * Not practical, but fun
    * Build our GS skills while having fun

## What are we building?
* Briefly explain the game rules.
* Show a GIF of the result.

{% include image.html src="/assets/images/codenames/part1/1.gif" caption
="What we're building." %}

## What skills are we going to learn?
* Write an App Script
    * Format cells programmatically
    * Show error messages in pop up dialogs
    * Edit the content of cells programmatically
* Create buttons and connecting them to scripts
* Create named ranges
* Import HTML tables from websites

## The series
* Part 1 - Creating the word list
* [Part 2 - Creating the player board]({% post_url /codenames/2020-01-13-part-2 %})
* [Part 3 - Creating the codemaster board]({% post_url /codenames/2020-01-13-part-3 %})
* [Part 4 - Programming the logic]({% post_url /codenames/2020-01-13-part-4 %})
* [Part 5 - Connecting UI elements to functions]({% post_url /codenames/2020-01-13-part-5 %})

-------

## Creating the word list

Create a new Sheet. Right-click the tab and rename it **Lists**.

In cell **A1**, enter this formula and hit enter:

`=IMPORTHTML("https://www.talkenglish.com/vocabulary/top-1500-nouns.aspx","table",1)`

{% include image.html src="/assets/images/codenames/part1/2.gif" caption
="Importing the word list." %}

You might notice it looks like nothing happened!

{% include message.html type="is-dark" title="IMPORTHTML(url, query, index)"
content="
This formula lets us import a data table from a website. 

The `url` parameter is the website we want the data from.
 
The `query` parameter tells Google to look for either table (`<table>` tags
) or list (`<ul>` and `<ol>` tags) DOM elements. 

The `index` parameter selects which result we want in case Google finds
 multiple tables or lists on the same page. 
" %}

In this case the first `<table>` element had no data in it, which is why our
 sheet is empty.

Try changing this parameter to `2`.

{% include image.html src="/assets/images/codenames/part1/3.png" %}

Nope.

Now try `3`.

{% include image.html src="/assets/images/codenames/part1/4.png" %}

Still no luck.

Try `4`.

{% include image.html src="/assets/images/codenames/part1/5.png" %}

Ah, there we go!

Try editing one of the words. You’ll create a `#REF` error because Sheets
needs that space to be blank so it can fill it with the data.

There is data in the table that we don’t actually need, plus a few blank
columns. To modify or delete the data we’ll need to copy and paste it as
values instead of using the current formula.

Select column **B** and copy it. Select cell **A1** and press `cmd+shift+V` to
 paste the values. The other columns will disappear since we just overwrote
 the formula that was generating them. Perfect!
 
{% include image.html src="/assets/images/codenames/part1/6.gif" caption
="Copying the data." %}

We’re also going to make two other lists that define the colors of the cells
.

{% include message.html type="is-dark" title="Color palette" content="Recall
that whichever team starts has one extra word to guess. So there will be one
grey cell (the assassin), 7 beige cells (citizens), 8 red cells , 8 blue cells, and one
extra red or blue cell depending on which team is starting." %}

{% include message.html type="is-info" title="Tip" content="Initially I defined the color lists in the App Script, but I ended up
 defining them in named ranges which results in cleaner code." %}

In column B enter `#ff9999` nine times, `#ccccff` eight times, beige seven
 times, and grey once. That should fill the range **B1:B25**. Copy that into
  **C1:C25**. Change C9 to be `#ccccff`. Create a named range for each of these
  ranges: **B1:B25** should be called red_starts, **C1:C25** should be called
   blue_starts.

`#ff9999` and `#ccccff` refer are the hex codes for a light red and light blue color, respectively. I’m using them because red and blue are darker colors that made it hard to read the text in the cell. We could have compensated for this by making the font color white, but I prefer just making the red and blue lighter.
