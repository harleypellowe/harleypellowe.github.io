---
title: "Habit Tracker"
subtitle: "Part 4: Resetting a habit"
permalink: "/projects/habit-tracker/part-4.html"
categories: [project]
layout: project
---
This is **Part 4** of the **Habit Tracker** project series. In this part, we're going to write the code that will reset a habit's checkboxes.

## The series

* [Part 1 - Creating the layout]({% post_url /habit-tracker/2020-01-13-part-1 %})
* [Part 2 - Adding a habit]({% post_url /habit-tracker/2020-01-13-part-2 %})
* [Part 3 - Encouraging the user]({% post_url /habit-tracker/2020-01-13-part-3 %})
* Part 4 - Resetting a habit

------

This last step doesn't take long to write and you've already used all of the commands in other functions, so if you want to challenge yourself, try implementing a **clearHabit** function on your own, then come back to compare your answer with mine.

Alright, first we'll get the current cell using the built-in **getCurrentCell()** function.

{% include message.html type="is-dark" title="Current cell vs selected cell" content="The current cell is the cell that has focus (i.e. is highlighted by a dark border). A selected cell has a light blue shade over it. While you can have many <b>selected</b> cells, there is only ever one <b>current</b> cell." %}

{% capture code %}
function clearHabit() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var ws = ss.getActiveSheet();
  var cell = ws.getCurrentCell();
}
{% endcapture %}
{% include code.html lang=js title="Code.gs" code=code %}

After getting a reference to the current cell, we determine the row in which the cell resides.

{% capture code %}
function clearHabit() {
  // .. previous code ...
  
  var row = cell.getRow();
}
{% endcapture %}
{% include code.html lang=js title="Code.gs" code=code %}

Before we clear the row, we should check to make sure it's a row containing a habit. Otherwise, we might mistakenly clear rows 1 or 2, which contain instructions and header info, or a row that's supposed to be empty.

We'll use an **if** statement to check for these conditions.

{% capture code %}
function clearHabit() {
  // ... previous code ...
  
  // Ignore the first two rows which just contain instructions
  // and headers.
  if (row > 2 && ws.getRange(row, 1).getValue() != '') {
    var range = ws.getRange(row, 1, 1, 17);
    range.uncheck();
    updateHabitStatus(ws, range);
  }
}
{% endcapture %}
{% include code.html lang=js title="Code.gs" code=code %}

If the row can be cleared, we select the columns that will be cleared, uncheck the checkboxes, and run our **updateHabitStatus** function to reset the colors and text.

The only thing left to do is assign the **clearHabit** function to the **Clear Selected Habit** button.

Go back to the sheet, right-click the **Clear Selected Habit** button, click the three vertical dots, and choose **Assign script**.

Enter `clearHabit`, and press **OK**.

Let's test it out.

Select a cell in a row that doesn't contain a habit and click **Clear Selected Habit**. Nothing should happen.

Select a cell in row 1 or 2 and click **Clear Selected Habit**. Nothing should happen.

Check some boxes in a row. Select a cell in that row and click **Clear Selected Habit**. The row should reset.

{% include image.html src="/assets/images/habit-tracker/part-5.gif" caption="Testing it out" %}

------
All done!